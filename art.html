<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Art - SlickestFox</title>
	<link rel="stylesheet" href="style.css"/>
</head>
<body>
	<header class="site-header">
		<h1>SlickestFox</h1>
		<nav>
			<a href="index.html">Home</a>
			<a href="art.html">Art</a>
			<a href="music.html">Music</a>
			<a href="videos.html">Videos</a>
			<a href="dog-posting.html">Dog-Posting™</a>
		</nav>
	</header>

	<!-- Full-bleed collage -->
	<div class="bleed">
		<div id="gallery" class="art-collage" aria-live="polite"></div>
	</div>

	<footer>
		<p>© 2025 SlickestFox</p>
	</footer>

	<!-- Lightbox -->
	<div id="lightbox" aria-modal="true" role="dialog">
		<img id="lightbox-img" alt="Artwork"/>
		<div class="hint">click / tap to close • ← / → to navigate</div>
	</div>

	<!-- Inline JSON (edit this). Keep double quotes. -->
	<script id="images-data" type="application/json">
	{
	"images": [
		{
			"src": "assets/art/cold.png",
			"title": "cold",
			"color": "#A7A7A7"
		},
		{
			"src": "assets/art/Macchi doodles.png",
			"title": "Macchi doodles",
			"color": "#E5E3E3"
		},
		{
			"src": "assets/art/gayslop 2.png",
			"title": "gayslop 2",
			"color": "#C1ABAA"
		},
		{
			"src": "assets/art/fox curled up.png",
			"title": "fox curled up",
			"color": "#8F5549"
		},
		{
			"src": "assets/art/macchi guitar playing V2.png",
			"title": "macchi guitar playing V2",
			"color": "#7F5A47"
		},
		{
			"src": "assets/art/serpertine art.png",
			"title": "serpertine art",
			"color": "#A0816E"
		},
		{
			"src": "assets/art/GLUNGUS.png",
			"title": "GLUNGUS",
			"color": "#7C5A43"
		},
		{
			"src": "assets/art/Macchi subway.png",
			"title": "Macchi subway",
			"color": "#B08B5E"
		},
		{
			"src": "assets/art/asriel x ralsei.png",
			"title": "asriel x ralsei",
			"color": "#87785F"
		},
		{
			"src": "assets/art/dog doodles.png",
			"title": "dog doodles",
			"color": "#F0D899"
		},
		{
			"src": "assets/art/Frizk fanart.png",
			"title": "Frizk fanart",
			"color": "#476A6A"
		},
		{
			"src": "assets/art/lucario underwater.png",
			"title": "lucario underwater",
			"color": "#356084"
		},
		{
			"src": "assets/art/deltarune roaring knight fight.png",
			"title": "deltarune roaring knight fight",
			"color": "#7D7BA9"
		},
		{
			"src": "assets/art/sylvius beach FINAL.png",
			"title": "sylvius beach FINAL",
			"color": "#B29FD1"
		},
		{
			"src": "assets/art/devious.png",
			"title": "devious",
			"color": "#CCB7E0"
		},
		{
			"src": "assets/art/Sylvius pfp remake.png",
			"title": "Sylvius pfp remake",
			"color": "#7E6784"
		},
		{
			"src": "assets/art/catnap & dogday actually kiss.png",
			"title": "catnap & dogday actually kiss",
			"color": "#7A2C53"
		},
		{
			"src": "assets/art/macchi bed guitar.png",
			"title": "macchi bed guitar",
			"color": "#62474B"
		}
	]
}
</script>

	<script>
	(()=>{"use strict";
	  const $ = (s,r=document)=>r.querySelector(s);
	  const IS_FILE = location.protocol === "file:";
	  const rgbaFromHex = (hex,a=0.9)=>{
		let h=String(hex||"").trim(); if(!h) return "";
		if(h[0]==="#") h=h.slice(1);
		if(h.length===3) h=h.split("").map(c=>c+c).join("");
		if(h.length!==6) return "";
		const r=parseInt(h.slice(0,2),16), g=parseInt(h.slice(2,4),16), b=parseInt(h.slice(4,6),16);
		return `rgba(${r}, ${g}, ${b}, ${a})`;
	  };

	  /* ---------- audio files ---------- */
	  const NOTE_URLS = [
		"assets/audio/notes/n1.mp3","assets/audio/notes/n2.mp3","assets/audio/notes/n3.mp3",
		"assets/audio/notes/n4.mp3","assets/audio/notes/n5.mp3","assets/audio/notes/n6.mp3","assets/audio/notes/n7.mp3"
	  ];
	  const CHORD_URLS = [
		"assets/audio/chords/c1.mp3","assets/audio/chords/c2.mp3","assets/audio/chords/c3.mp3",
		"assets/audio/chords/c4.mp3","assets/audio/chords/c5.mp3","assets/audio/chords/c6.mp3","assets/audio/chords/c7.mp3"
	  ];
	  const SFX_URLS = ["assets/audio/sfx/a.mp3","assets/audio/sfx/b.mp3","assets/audio/sfx/c.mp3","assets/audio/sfx/d.mp3","assets/audio/sfx/e.mp3"];

	  /* ---------- gate ---------- */
	  let audioGate=false;
	  function showGate(){ let g=$("#sound-gate"); if(!g){ g=document.createElement("div"); g.id="sound-gate"; g.textContent="🔊 Click to enable sound"; document.body.appendChild(g);} g.classList.add("show"); }
	  function hideGate(){ const g=$("#sound-gate"); if(g) g.classList.remove("show"); }
	  function wireGate(){ showGate(); const enable=()=>{ audioGate=true; hideGate(); document.removeEventListener("click",enable); }; document.addEventListener("click",enable); $("#sound-gate").addEventListener("click",enable,{passive:true}); }

	  /* ---------- polyphonic notes (no cut-off) ---------- */
	  const MAX_POLY = 6;
	  const playingNotes = [];
	  let currentNote = Math.floor(Math.random()*7);
	  const PROB_NEXT = 0.70;

	  function playNoteIndex(i, hostEl){
		if (!audioGate || !NOTE_URLS.length) return;
		while (playingNotes.length >= MAX_POLY){ const a = playingNotes.shift(); try{ a.pause(); }catch{} }
		const a = new Audio();
		if (!IS_FILE) a.crossOrigin = "anonymous";
		a.src = NOTE_URLS[i];
		a.volume = 0.9;
		a.play().catch(()=>{});
		a.addEventListener("ended", ()=>{ const k=playingNotes.indexOf(a); if(k>=0) playingNotes.splice(k,1); });
		playingNotes.push(a);

		hostEl.classList.add("playing","focused");
		setTimeout(()=>hostEl.classList.remove("playing"),220);
	  }
	  function stopAllNotes(){ while(playingNotes.length){ const a=playingNotes.pop(); try{ a.pause(); }catch{} } }

	  /* ---------- chords (I/IV/V favored) ---------- */
	  const CHORD_WEIGHTS = [0.28,0.10,0.08,0.22,0.22,0.09,0.01];
	  function weightedPick(ws){ const r=Math.random(); let a=0; for(let i=0;i<ws.length;i++){ a+=ws[i]; if(r<=a) return i; } return ws.length-1; }
	  function playChord(){
		if (!audioGate || !CHORD_URLS.length) return;
		const a = new Audio(); if(!IS_FILE) a.crossOrigin="anonymous";
		a.src = CHORD_URLS[weightedPick(CHORD_WEIGHTS)]; a.volume=0.95; a.play().catch(()=>{});
	  }

	  /* ---------- burst SFX (harder to trigger) ---------- */
	  // These are the ones to tweak:
	  // friendlier burst sensitivity
		const NOTE_BURST_WINDOW_MS   = 500;  // look over ~1.2s
		const NOTE_BURST_THRESHOLD   = 9;     // total notes needed
		const NOTE_BURST_DISTINCT_MIN= 7;    // from at least 5 different images
		const SFX_COOLDOWN_MS        = 2500;  // cooldown after triggering


	  let noteEvents=[];                     // {t, id}
	  let lastSfxAt = 0;

	  function registerNoteAndMaybeSfx(el){
		const now = performance.now();
		const id = el.dataset._id;
		noteEvents.push({ t: now, id });

		// keep only recent
		noteEvents = noteEvents.filter(e => now - e.t <= NOTE_BURST_WINDOW_MS);

		const total = noteEvents.length;
		const distinct = new Set(noteEvents.map(e=>e.id)).size;

		if (total >= NOTE_BURST_THRESHOLD &&
			distinct >= NOTE_BURST_DISTINCT_MIN &&
			(now - lastSfxAt) > SFX_COOLDOWN_MS){
		  lastSfxAt = now;
		  const s = new Audio(); if(!IS_FILE) s.crossOrigin="anonymous";
		  s.src = SFX_URLS[(Math.random()*SFX_URLS.length)|0];
		  s.volume = 1.0; s.play().catch(()=>{});
		  noteEvents.length = 0;
		}
	  }

	  /* ---------- render ---------- */
	  let images=[];
	  function render(list){
		const box = $("#gallery"); const frag=document.createDocumentFragment();
		list.forEach((it, idx)=>{
		  const fig = document.createElement("figure");
		  fig.className = "art-item";
		  fig.dataset._id = String(idx);         // for burst distinct counting
		  fig.style.setProperty("--gox","50%");  fig.style.setProperty("--goy","85%");
		  if (it.color){ const tint=rgbaFromHex(it.color,0.90); if(tint) fig.style.setProperty("--glow",tint); }

		  const img = document.createElement("img");
		  img.loading="lazy"; img.decoding="async";
		  if(!IS_FILE) img.crossOrigin="anonymous";
		  img.src = it.src; img.alt = it.title || "Artwork"; img.tabIndex = 0;

		  // pointer tracks glow origin
		  fig.addEventListener("pointermove",(e)=>{
			const r=fig.getBoundingClientRect();
			const x=((e.clientX-r.left)/r.width*100).toFixed(2)+"%";
			const y=((e.clientY-r.top )/r.height*100).toFixed(2)+"%";
			fig.style.setProperty("--gox",x); fig.style.setProperty("--goy",y);
		  });

		  // focus/hover state (for CSS glow)
		  fig.addEventListener("pointerenter",()=>fig.classList.add("focused"));
		  fig.addEventListener("pointerleave",()=>fig.classList.remove("focused"));
		  img.addEventListener("focus",()=>fig.classList.add("focused"));
		  img.addEventListener("blur",()=>fig.classList.remove("focused"));

		  // sound on hover/focus
		  fig.addEventListener("pointerenter", ()=>{
			const r=Math.random();
			if (r < PROB_NEXT) currentNote = (currentNote + 1) % NOTE_URLS.length;
			else if (r >= 0.85) currentNote = (currentNote - 1 + NOTE_URLS.length) % NOTE_URLS.length;
			playNoteIndex(currentNote, fig);
			registerNoteAndMaybeSfx(fig);
		  }, {passive:true});
		  img.addEventListener("focus", ()=>{
			playNoteIndex(currentNote, fig);
			registerNoteAndMaybeSfx(fig);
		  }, {passive:true});

		  // click → chord + lightbox
		  img.addEventListener("click", ()=>{ playChord(); openLightbox(idx); });
		  img.addEventListener("keydown",(e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); playChord(); openLightbox(idx);} });

		  fig.appendChild(img);
		  frag.appendChild(fig);
		});
		box.innerHTML=""; box.appendChild(frag);
	  }

	  /* ---------- lightbox ---------- */
	  const lb=$("#lightbox"), lbImg=$("#lightbox-img");
	  function openLightbox(i){ if(i<0||i>=images.length) return; lbImg.src=images[i].src; lb.classList.add("show"); document.body.style.overflow="hidden"; }
	  function closeLightbox(){ lb.classList.remove("show"); lbImg.src=""; document.body.style.overflow=""; }
	  function next(){ if(images.length) openLightbox((currentIndex()+1)%images.length); }
	  function prev(){ if(images.length) openLightbox((currentIndex()-1+images.length)%images.length); }
	  function currentIndex(){ const s=lbImg.src; return Math.max(0, images.findIndex(x=>x.src===s)); }
	  lb.addEventListener("click", closeLightbox);
	  document.addEventListener("keydown",(e)=>{ if(!lb.classList.contains("show"))return; if(e.key==="Escape")closeLightbox(); else if(e.key==="ArrowRight")next(); else if(e.key==="ArrowLeft")prev(); });

	  /* ---------- boot ---------- */
	  document.addEventListener("DOMContentLoaded", ()=>{
		let data={images:[]};
		try{ data = JSON.parse($("#images-data")?.textContent || "{}"); }catch{}
		images = Array.isArray(data.images) ? data.images.map(it=>({ src:String(it.src||"").trim(), title:String(it.title||""), color:String(it.color||"") })) : [];
		render(images);
		wireGate();
	  });
	})();
	</script>

</body>
</html>
