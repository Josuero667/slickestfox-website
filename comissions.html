<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Commissions - SlickestFox</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Background pattern layers -->
  <div class="bg bg-circles" aria-hidden="true"></div>
  <div class="bg bg-pluses" aria-hidden="true"></div>

  <header class="site-header">
    <h1>SlickestFox</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="art.html">Art</a>
      <a href="music.html">Music</a>
      <a href="videos.html">Videos</a>
      <a href="comissions.html">Commissions</a>
      <a href="dog-posting.html">Dog-PostingT</a>
    </nav>
  </header>

  <main class="container">
    <section class="intro">
      <h3>Commissions</h3>
      <p class="muted">Temporary UI testing area for the Luna-style decorative windows. These are not draggable â€” just styled frames to showcase content.</p>
    </section>

    <!-- Demo windows: active and inactive, with fallback styling if assets are missing -->
    <div class="luna-window" style="margin: 20px 0;">
      <div class="luna-titlebar"><span class="luna-title">Active Window</span>
        <div class="luna-controls" aria-hidden="false">
          <button class="luna-btn minimize" title="Minimize" aria-label="Minimize"></button>
          <button class="luna-btn maximize" title="Maximize" aria-label="Maximize"></button>
          <button class="luna-btn close" title="Close" aria-label="Close"></button>
        </div>
      </div>
      <div class="luna-body">
        <p>This is a placeholder content box using the Luna window frame. When your handâ€‘drawn border images are added to <code>assets/ui/luna/</code>, this will automatically pick them up.</p>
      </div>
    </div>


    <!-- Preview: small, medium, wide, and tall windows -->
    <div class="luna-window" style="margin:20px 0; max-width: 320px;">
      <div class="luna-titlebar"><span class="luna-title">Small Preview</span>
        <div class="luna-controls" aria-hidden="false">
          <button class="luna-btn minimize" title="Minimize" aria-label="Minimize"></button>
          <button class="luna-btn maximize" title="Maximize" aria-label="Maximize"></button>
          <button class="luna-btn close" title="Close" aria-label="Close"></button>
        </div>
      </div>
      <div class="luna-body">
        <p>Short content. Width ~320px to test corners and side repeat.</p>
      </div>
    </div>

    <div class="luna-window" style="margin:20px 0; max-width: 560px;">
      <div class="luna-titlebar"><span class="luna-title">Medium Preview</span>
        <div class="luna-controls" aria-hidden="false">
          <button class="luna-btn minimize" title="Minimize" aria-label="Minimize"></button>
          <button class="luna-btn maximize" title="Maximize" aria-label="Maximize"></button>
          <button class="luna-btn close" title="Close" aria-label="Close"></button>
        </div>
      </div>
      <div class="luna-body">
        <p>Middle width to ensure the center strips tile nicely.</p>
      </div>
    </div>

    <div class="luna-window" style="margin:20px 0;">
      <div class="luna-titlebar"><span class="luna-title">Wide Preview</span>
        <div class="luna-controls" aria-hidden="false">
          <button class="luna-btn minimize" title="Minimize" aria-label="Minimize"></button>
          <button class="luna-btn maximize" title="Maximize" aria-label="Maximize"></button>
          <button class="luna-btn close" title="Close" aria-label="Close"></button>
        </div>
      </div>
      <div class="luna-body">
        <img class="luna-img" src="assets/banner.jpg" alt="Banner preview" />
        <p style="margin-top:10px">Full container width with an image banner. Long line of text to test wrapping beneath the image. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas porttitor felis non libero facilisis.</p>
      </div>
    </div>

    <div class="luna-window" style="margin:20px 0; max-width: 460px;">
      <div class="luna-titlebar"><span class="luna-title">Tall Preview</span>
        <div class="luna-controls" aria-hidden="false">
          <button class="luna-btn minimize" title="Minimize" aria-label="Minimize"></button>
          <button class="luna-btn maximize" title="Maximize" aria-label="Maximize"></button>
          <button class="luna-btn close" title="Close" aria-label="Close"></button>
        </div>
      </div>
      <div class="luna-body">
        <img class="luna-img pixelated" src="assets/ui/luna/titlebar-left.png" alt="Pixel sticker" style="width:96px; image-rendering: pixelated;" />
        <p style="margin-top:10px">Multi-paragraph content to test the bottom frame repeat. Includes a small pixelated sticker image for decoration.</p>
        <p style="margin-top:10px">Vivamus commodo, nunc vitae dapibus tincidunt, sem sem feugiat mi, a fringilla lectus lacus eu odio. Cras posuere risus nec nisl gravida, ut viverra augue tempor.</p>
        <p style="margin-top:10px">Suspendisse bibendum massa vel elit molestie, vitae efficitur mauris vulputate.</p>
      </div>
    </div>

    <div class="luna-window" style="margin:20px 0; max-width: 360px;">
      <div class="luna-titlebar"><span class="luna-title">Image Post</span>
        <div class="luna-controls" aria-hidden="false">
          <button class="luna-btn minimize" title="Minimize" aria-label="Minimize"></button>
          <button class="luna-btn maximize" title="Maximize" aria-label="Maximize"></button>
          <button class="luna-btn close" title="Close" aria-label="Close"></button>
        </div>
      </div>
      <div class="luna-body">
        <img class="luna-img" src="assets/ui/luna/titlebar-right.png" alt="Decorative corner art" style="width:100%; max-width:320px;" />
        <p style="margin-top:8px" class="muted">Caption: decorative preview using UI corner art as placeholder texture.</p>
      </div>
    </div>
  </main>

  <footer>
    <p>c 2025 SlickestFox</p>
  </footer>

  <!-- Inline JSON (loop config) -->
  <script id="loop-data" type="application/json">
  {
    "loops": [
      { "src": "assets/audio/loops/index.ogg" },
      { "src": "assets/audio/loops/art.ogg" }
    ]
  }
  </script>

  <!-- Background Audio Script (with saved prefs + first-gesture autoplay) -->
  <script>
  (() => {
    const LS_MUTE_KEY = 'siteAudioMuted';
    const LS_VOL_KEY = 'siteAudioVolume';
    let audioEl = null;

    const loadPrefs = () => {
      let muted = true; let vol = 0.5;
      try {
        const m = localStorage.getItem(LS_MUTE_KEY);
        const v = localStorage.getItem(LS_VOL_KEY);
        if (m !== null) muted = (m === '1');
        if (v !== null) { const nv = Math.max(0, Math.min(1, parseFloat(v))); if (!Number.isNaN(nv)) vol = nv; }
      } catch {}
      return { muted, vol };
    };
    const saveMute = (m) => { try { localStorage.setItem(LS_MUTE_KEY, m ? '1' : '0'); } catch {} };
    const saveVol  = (v) => { try { localStorage.setItem(LS_VOL_KEY, String(v)); } catch {} };

    document.addEventListener('DOMContentLoaded', () => {
      let data = {}; try { data = JSON.parse(document.getElementById('loop-data').textContent); } catch {}
      const loops = Array.isArray(data.loops) ? data.loops : [];
      if (!loops.length) return;
      const src = loops[(Math.random() * loops.length) | 0].src;

      audioEl = new Audio(src);
      audioEl.loop = true;

      const { muted, vol } = loadPrefs();
      audioEl.volume = vol;
      audioEl.muted = muted;
      audioEl.play().catch(() => {});

      // First gesture resume if needed
      const onFirstGesture = () => {
        if (!audioEl) return;
        if (!audioEl.muted && audioEl.paused) { audioEl.play().catch(() => {}); }
        window.removeEventListener('pointerdown', onFirstGesture);
        window.removeEventListener('keydown', onFirstGesture);
      };
      window.addEventListener('pointerdown', onFirstGesture, { passive: true });
      window.addEventListener('keydown', onFirstGesture);

      // Controls UI
      const controls = document.createElement('div');
      controls.id = 'music-controls';
      const btn = document.createElement('button');
      btn.id = 'mute-btn';
      btn.textContent = (muted || vol === 0) ? 'ðŸ”‡' : 'ðŸ”Š';
      const slider = document.createElement('input');
      slider.type = 'range';
      slider.id = 'volume-slider';
      slider.min = '0'; slider.max = '1'; slider.step = '0.01';
      slider.value = String(vol);

      btn.addEventListener('click', () => {
        if (!audioEl) return;
        audioEl.muted = !audioEl.muted;
        saveMute(audioEl.muted);
        btn.textContent = (audioEl.muted || audioEl.volume == 0) ? 'ðŸ”‡' : 'ðŸ”Š';
        if (!audioEl.muted && audioEl.paused) { audioEl.play().catch(() => {}); }
      });

      slider.addEventListener('input', () => {
        if (!audioEl) return;
        const v = Math.max(0, Math.min(1, parseFloat(slider.value)));
        audioEl.volume = v;
        saveVol(v);
        btn.textContent = (audioEl.muted || v === 0) ? 'ðŸ”‡' : 'ðŸ”Š';
      });

      window.addEventListener('storage', (e) => {
        if (!audioEl) return;
        if (e.key === LS_MUTE_KEY && e.newValue != null) {
          audioEl.muted = (e.newValue === '1');
          btn.textContent = (audioEl.muted || audioEl.volume == 0) ? 'ðŸ”‡' : 'ðŸ”Š';
          if (!audioEl.muted && audioEl.paused) { audioEl.play().catch(() => {}); }
        }
        if (e.key === LS_VOL_KEY && e.newValue != null) {
          const v = Math.max(0, Math.min(1, parseFloat(e.newValue)));
          if (!Number.isNaN(v)) { audioEl.volume = v; slider.value = String(v); }
          btn.textContent = (audioEl.muted || audioEl.volume == 0) ? 'ðŸ”‡' : 'ðŸ”Š';
        }
      });

      controls.appendChild(btn);
      controls.appendChild(slider);
      document.body.appendChild(controls);
    });
  })();
  </script>

  <!-- Titlebar button SFX (per-button, overlapping, on press) -->
  <script>
  (function(){
    const SOURCES = {
      minimize: 'assets/ui/luna/minimize.mp3',
      maximize: 'assets/ui/luna/maximize.mp3',
      close:    'assets/ui/luna/close.mp3',
      default:  'assets/ui/luna/click.mp3'
    };
    const cache = new Map();
    const LS_MUTE_KEY = 'siteAudioMuted';
    const LS_VOL_KEY  = 'siteAudioVolume';
    function getGlobal(){
      let muted = false, vol = 1;
      try {
        const m = localStorage.getItem(LS_MUTE_KEY);
        const v = localStorage.getItem(LS_VOL_KEY);
        if (m !== null) muted = (m === '1');
        if (v !== null) { const nv = parseFloat(v); if (!Number.isNaN(nv)) vol = Math.max(0, Math.min(1, nv)); }
      } catch {}
      return { muted, vol };
    }
    function getAudio(key){
      const src = SOURCES[key] || SOURCES.default;
      if (!cache.has(src)){
        try {
          const a = new Audio(src);
          a.preload = 'auto';
          a.volume = 0.6; // base SFX level, will be scaled by global vol
          cache.set(src, a);
        } catch { cache.set(src, null); }
      }
      return cache.get(src);
    }
    function playKey(key){
      const { muted, vol } = getGlobal();
      if (muted || vol === 0) return; // respect global mute/volume
      const base = getAudio(key);
      if (!base) return;
      try {
        // Clone to allow overlapping playback without cutting off previous ones
        const inst = base.cloneNode(true);
        inst.volume = base.volume * vol;
        inst.play().catch(()=>{});
      } catch {}
    }
    window.addEventListener('DOMContentLoaded', () => {
      document.body.addEventListener('pointerdown', (e) => {
        const btn = e.target.closest('.luna-btn');
        if (!btn) return;
        if (btn.classList.contains('minimize')) return playKey('minimize');
        if (btn.classList.contains('maximize')) return playKey('maximize');
        if (btn.classList.contains('close'))    return playKey('close');
        playKey('default');
      }, { passive: true });
    });
  })();
  </script>

  <!-- Title wave effect: split text into spans and animate (preserve spaces) -->
  <script>
  (function(){
    function applyWave(el){
      const text = el.textContent;
      el.textContent = '';
      el.classList.add('wave');
      let index = 0;
      for (let i=0;i<text.length;i++){
        const ch = text[i];
        if (ch === ' '){
          // Preserve spaces as text nodes so spacing remains intact
          el.appendChild(document.createTextNode(' '));
          continue;
        }
        const span = document.createElement('span');
        span.className = 'char';
        span.style.setProperty('--i', index++);
        span.textContent = ch;
        el.appendChild(span);
      }
    }
    window.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.luna-titlebar .luna-title').forEach(applyWave);
    });
  })();
  </script>
</body>
</html>
